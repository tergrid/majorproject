/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.29/esri/copyright.txt for details.
*/
import e from"../config.js";import{version as t}from"../kernel.js";import{ArcadeDate as n,createDateTimeZone as r}from"../arcade/ArcadeDate.js";import{ArcadeModule as a}from"../arcade/ArcadeModule.js";import{ArcadeExecutionError as i,ExecutionErrorCodes as o}from"../arcade/executionError.js";import{ArcadeFunction as u}from"../arcade/FunctionWrapper.js";import l from"../arcade/ImmutableArray.js";import s from"../arcade/ImmutablePathArray.js";import f from"../arcade/ImmutablePointArray.js";import{esriFieldToJson as c,layerGeometryEsriRestConstants as m}from"../arcade/featureset/support/shared.js";import{format as d,parse as p}from"../core/number.js";import{DateOnly as y}from"../core/sql/DateOnly.js";import{TimeOnly as g}from"../core/sql/TimeOnly.js";import h from"../geometry/Extent.js";import b from"../geometry/Geometry.js";import N from"../geometry/Multipoint.js";import S from"../geometry/Point.js";import x from"../geometry/Polygon.js";import Z from"../geometry/Polyline.js";import D from"../geometry/SpatialReference.js";import{isClockwise as T}from"../geometry/support/coordsUtils.js";import{fromJSON as k}from"../geometry/support/jsonUtils.js";import{getLocale as A}from"../intl/locale.js";import{DateTime as C}from"luxon";class j{constructor(e){this.value=e}}class M{constructor(e){this.value=e}}const F=M,w=j,O={type:"VOID"},R={type:"BREAK"},J={type:"CONTINUE"};function v(e,t,n){return""===t||null==t||t===n||t===n?e:e=e.split(t).join(n)}function I(e){return e instanceof u}function _(e){return e instanceof a}function L(e){return!!G(e)||(!!E(e)||(!!X(e)||(!!ee(e)||(!!te(e)||(!!z(e)||(null===e||(e===O||"number"==typeof e)))))))}function Y(e,t){return void 0===e?t:e}function P(e){return null==e?"":U(e)||Q(e)?"Array":X(e)?"Date":te(e)?"Time":ee(e)?"DateOnly":G(e)?"String":z(e)?"Boolean":E(e)?"Number":"esri.arcade.Attachment"===e?.declaredClass?"Attachment":"esri.arcade.Portal"===e?.declaredClass?"Portal":"esri.arcade.Dictionary"===e?.declaredClass?"Dictionary":$(e)?"KnowledgeGraph":e instanceof a?"Module":H(e)?"Feature":e instanceof S?"Point":e instanceof x?"Polygon":e instanceof Z?"Polyline":e instanceof N?"Multipoint":e instanceof h?"Extent":I(e)?"Function":B(e)?"FeatureSet":W(e)?"FeatureSetCollection":e===O?"":"number"==typeof e&&isNaN(e)?"Number":"Unrecognized Type"}function G(e){return"string"==typeof e||e instanceof String}function z(e){return"boolean"==typeof e}function E(e){return"number"==typeof e}function V(e){return"number"==typeof e&&isFinite(e)&&Math.floor(e)===e}function q(e){return e instanceof b}function U(e){return e instanceof Array}function H(e){return"esri.arcade.Feature"===e?.arcadeDeclaredClass}function B(e){return"esri.arcade.featureset.support.FeatureSet"===e?.declaredRootClass}function K(e){return"esri.arcade.Dictionary"===e?.declaredClass}function W(e){return"esri.arcade.featureSetCollection"===e?.declaredRootClass}function $(e){return"esri.rest.knowledgeGraph.KnowledgeGraph"===e?.declaredClass}function Q(e){return e instanceof l}function X(e){return e instanceof n}function ee(e){return e instanceof y}function te(e){return e instanceof g}function ne(e){return null!=e&&"object"==typeof e}function re(e){return e instanceof Date}function ae(e,t,n,r,a){if(e.length<t||e.length>n)throw new i(r,o.WrongNumberOfParameters,a)}function ie(e){return e<0?-Math.round(-e):Math.round(e)}function oe(){let e=Date.now();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replaceAll(/[xy]/g,(t=>{const n=(e+16*Math.random())%16|0;return e=Math.floor(e/16),("x"===t?n:3&n|8).toString(16)}))}function ue(e,t){return isNaN(e)||null==t||""===t?e.toString():(t=v(t,"‰",""),t=v(t,"¤",""),d(e,{pattern:t}))}function le(e,t){return null==t||""===t?e.toISOString(!0):e.toFormat(se(t),{locale:A(),numberingSystem:"latn"})}function se(e,t=!1){e=e.replaceAll(/LTS|LT|LL?L?L?|l{1,4}/g,"[$&]");let n="";const r=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|N{1,5}|YYYYYY|YYYYY|YYYY|YY|y{2,4}|yo?|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|Z{1,5}|.)/g;for(const a of e.match(r)||[])switch(a){case"D":n+="d";break;case"DD":n+="dd";break;case"DDD":n+="o";break;case"d":n+="c";break;case"ddd":n+="ccc";break;case"dddd":n+="cccc";break;case"M":n+="L";break;case"MM":n+="LL";break;case"MMM":n+="LLL";break;case"MMMM":n+="LLLL";break;case"YY":n+="yy";break;case"Y":case"YYYY":n+="yyyy";break;case"Q":n+="q";break;case"Z":n+="Z";break;case"ZZ":n+="ZZ";break;case"ZZZ":n+="ZZZ";break;case"ZZZZ":n+=t?"[ZZZZ]":"ZZZZ";break;case"ZZZZZ":n+=t?"[ZZZZZ]":"ZZZZZ";break;case"S":n+="'S'";break;case"SS":n+="'SS'";break;case"SSS":n+="u";break;case"A":case"a":n+="a";break;case"m":case"mm":case"h":case"hh":case"H":case"HH":case"s":case"ss":case"X":case"x":n+=a;break;default:a.length>=2&&"["===a.slice(0,1)&&"]"===a.slice(-1)?n+=`'${a.slice(1,-1)}'`:n+=`'${a}'`}return n}function fe(e,t,n){switch(n){case">":return e>t;case"<":return e<t;case">=":return e>=t;case"<=":return e<=t}return!1}function ce(e,t,r){if(null===e){if(null===t||t===O)return fe(null,null,r);if(E(t))return fe(0,t,r);if(G(t))return fe(0,he(t),r);if(z(t))return fe(0,he(t),r);if(X(t))return fe(0,t.toNumber(),r);if(te(t))return fe(e,t.toNumber(),r);if(ee(t))return fe(e,t.toNumber(),r)}if(e===O){if(null===t||t===O)return fe(null,null,r);if(E(t))return fe(0,t,r);if(G(t))return fe(0,he(t),r);if(z(t))return fe(0,he(t),r);if(X(t))return fe(0,t.toNumber(),r);if(te(t))return fe(e,t.toNumber(),r);if(ee(t))return fe(e,t.toNumber(),r)}else if(E(e)){if(E(t))return fe(e,t,r);if(z(t))return fe(e,he(t),r);if(null===t||t===O)return fe(e,0,r);if(G(t))return fe(e,he(t),r);if(X(t))return fe(e,t.toNumber(),r);if(te(t))return fe(e,t.toNumber(),r);if(ee(t))return fe(e,t.toNumber(),r)}else if(G(e)){if(G(t))return fe(de(e),de(t),r);if(X(t))return fe(he(e),t.toNumber(),r);if(te(t))return fe(he(e),t.toNumber(),r);if(ee(t))return fe(he(e),t.toNumber(),r);if(E(t))return fe(he(e),t,r);if(null===t||t===O)return fe(he(e),0,r);if(z(t))return fe(he(e),he(t),r)}else if(X(e)){if(X(t))return e.timeZone!==t.timeZone&&(e.isUnknownTimeZone?e=n.arcadeDateAndZoneToArcadeDate(e,t.timeZone):t.isUnknownTimeZone&&(t=n.arcadeDateAndZoneToArcadeDate(t,e.timeZone))),fe(e.toNumber(),t.toNumber(),r);if(null===t||t===O)return fe(e.toNumber(),0,r);if(E(t))return fe(e.toNumber(),t,r);if(z(t))return fe(e.toNumber(),he(t),r);if(G(t))return fe(e.toNumber(),he(t),r);if(te(t))throw new i(null,o.CannotCompareDateAndTime,null);if(ee(t))return fe(e.toNumber(),t.toNumber(),r)}else if(z(e)){if(z(t))return fe(e,t,r);if(E(t))return fe(he(e),he(t),r);if(X(t))return fe(he(e),t.toNumber(),r);if(te(t))return fe(he(e),t.toNumber(),r);if(ee(t))return fe(he(e),t.toNumber(),r);if(null===t||t===O)return fe(he(e),0,r);if(G(t))return fe(he(e),he(t),r)}else if(ee(e)){if(X(t))return fe(e.toNumber(),t.toNumber(),r);if(null===t||t===O)return fe(e.toNumber(),0,r);if(E(t))return fe(e.toNumber(),t,r);if(z(t))return fe(e.toNumber(),he(t),r);if(G(t))return fe(e.toNumber(),he(t),r);if(te(t))throw new i(null,o.CannotCompareDateAndTime,null);if(ee(t))return fe(e.toNumber(),t.toNumber(),r)}else if(te(e)){if(X(t))throw new i(null,o.CannotCompareDateAndTime,null);if(null===t||t===O)return fe(e.toNumber(),0,r);if(E(t))return fe(e.toNumber(),t,r);if(z(t))return fe(e.toNumber(),he(t),r);if(G(t))return fe(e.toNumber(),he(t),r);if(te(t))return fe(e.toNumber(),t.toNumber(),r);if(ee(t))throw new i(null,o.CannotCompareDateAndTime,null)}return!!me(e,t)&&("<="===r||">="===r)}function me(e,t){if(e===t)return!0;if(null===e&&t===O||null===t&&e===O)return!0;if(X(e)&&X(t))return e.equals(t);if(te(e)&&te(t))return e.equals(t);if(ee(e)&&ee(t))return e.equals(t);if(e instanceof s)return e.equalityTest(t);if(e instanceof f)return e.equalityTest(t);if(e instanceof S&&t instanceof S){const n=e.cache._arcadeCacheId,r=t.cache._arcadeCacheId;if(null!=n)return n===r}if(ne(e)&&ne(t)){if(e._arcadeCacheId===t._arcadeCacheId&&void 0!==e._arcadeCacheId&&null!==e._arcadeCacheId)return!0;if(e._underlyingGraphic===t._underlyingGraphic&&void 0!==e._underlyingGraphic&&null!==e._underlyingGraphic)return!0}return!1}function de(e,t){if(G(e))return e;if(null===e)return"";if(E(e))return ue(e,t);if(z(e))return e.toString();if(X(e))return le(e,t);if(te(e))return e.toFormat(t);if(ee(e))return e.toFormat(t);if(e instanceof b)return JSON.stringify(e.toJSON());if(U(e)){const t=[];for(let n=0;n<e.length;n++)t[n]=ge(e[n]);return"["+t.join(",")+"]"}if(e instanceof l){const t=[];for(let n=0;n<e.length();n++)t[n]=ge(e.get(n));return"["+t.join(",")+"]"}return null!==e&&"object"==typeof e&&void 0!==e.castToText?e.castToText():I(e)?"object, Function":e===O?"":_(e)?"object, Module":""}function pe(e){const t=[];if(!U(e))return null;if(e instanceof l){for(let n=0;n<e.length();n++)t[n]=he(e.get(n));return t}for(let n=0;n<e.length;n++)t[n]=he(e[n]);return t}function ye(e,t,n=!1){if(G(e))return e;if(null===e)return"";if(E(e))return ue(e,t);if(z(e))return e.toString();if(X(e))return le(e,t);if(te(e))return e.toFormat(t);if(ee(e))return e.toFormat(t);if(e instanceof b)return e instanceof h?'{"xmin":'+e.xmin.toString()+',"ymin":'+e.ymin.toString()+","+(e.hasZ?'"zmin":'+e.zmin.toString()+",":"")+(e.hasM?'"mmin":'+e.mmin.toString()+",":"")+'"xmax":'+e.xmax.toString()+',"ymax":'+e.ymax.toString()+","+(e.hasZ?'"zmax":'+e.zmax.toString()+",":"")+(e.hasM?'"mmax":'+e.mmax.toString()+",":"")+'"spatialReference":'+je(e.spatialReference)+"}":je(e.toJSON(),((e,t)=>e.key===t.key?0:"spatialReference"===e.key?1:"spatialReference"===t.key||e.key<t.key?-1:e.key>t.key?1:0));if(U(e)){const t=[];for(let r=0;r<e.length;r++)t[r]=ge(e[r],n);return"["+t.join(",")+"]"}if(e instanceof l){const t=[];for(let r=0;r<e.length();r++)t[r]=ge(e.get(r),n);return"["+t.join(",")+"]"}return null!==e&&"object"==typeof e&&void 0!==e.castToText?e.castToText(n):I(e)?"object, Function":e===O?"":_(e)?"object, Module":""}function ge(e,t=!1){if(null===e)return"null";if(z(e)||E(e)||G(e))return JSON.stringify(e);if(e instanceof b)return ye(e,null,t);if(e instanceof l)return ye(e,null,t);if(e instanceof Array)return ye(e,null,t);if(X(e))return t?JSON.stringify(e.getTime()):JSON.stringify(le(e,""));if(te(e))return JSON.stringify(e.toString());if(ee(e))return JSON.stringify(e.toString());if(null!==e&&"object"==typeof e){if(void 0!==e.castToText)return e.castToText(t)}else if(e===O)return"null";return"null"}function he(e,t){return E(e)?e:null===e||""===e?0:X(e)||ee(e)||te(e)?NaN:z(e)?e?1:0:U(e)||""===e||void 0===e?NaN:void 0!==t&&G(e)?(t=v(t,"‰",""),t=v(t,"¤",""),p(e,{pattern:t})):e===O?0:Number(e)}function be(e,t){if(X(e))return e;if(G(e)){const r=Ne(e,t);if(r)return n.dateTimeToArcadeDate(r)}return null}function Ne(e,t){const n=/ (\d\d)/,a=r(t);let i=C.fromISO(e,{zone:a});return i.isValid||n.test(e)&&(e=e.replace(n,"T$1"),i=C.fromISO(e,{zone:t}),i.isValid)?i:null}function Se(e){return z(e)?e:G(e)?"true"===(e=e.toLowerCase()):!!E(e)&&(0!==e&&!isNaN(e))}function xe(e,t){const n=JSON.parse(e);return n&&!n.spatialReference&&(n.spatialReference=t),k(n)}function Ze(e,t){return null==e?null:(null!==e.spatialReference&&void 0!==e.spatialReference||(e.spatialReference=t),e)}function De(e){if(null===e)return null;if(e instanceof S)return"NaN"===e.x||null===e.x||isNaN(e.x)?null:e;if(e instanceof x){if(0===e.rings.length)return null;for(const t of e.rings)if(t.length>0)return e;return null}if(e instanceof Z){if(0===e.paths.length)return null;for(const t of e.paths)if(t.length>0)return e;return null}return e instanceof N?0===e.points.length?null:e:e instanceof h?"NaN"===e.xmin||null===e.xmin||isNaN(e.xmin)?null:e:null}function Te(e,t){if(!e)return t;if(!e.domain)return t;let n=null,r=null;if(X(t))n=t.toNumber();else if(ee(t))n=t.toString();else if(te(t))n=t.toStorageString();else if("string"===e.field.type||"esriFieldTypeString"===e.field.type)n=de(t);else{if(null==t)return null;if(""===t)return t;n=he(t)}for(let a=0;a<e.domain.codedValues.length;a++){const t=e.domain.codedValues[a];t.code===n&&(r=t)}return null===r?de(t):r.name}function ke(e,t){if(!e)return t;if(!e.domain)return t;let n=null;const r=de(t);for(let a=0;a<e.domain.codedValues.length;a++){const t=e.domain.codedValues[a];t.name===r&&(n=t)}return null===n?t:n.code}function Ae(e,t,n=null,r=null){if(!t)return null;if(!t.fields)return null;let a,u,l=null;for(let i=0;i<t.fields.length;i++){const n=t.fields[i];n.name.toLowerCase()===e.toString().toLowerCase()&&(l=n)}if(null===l)throw new i(null,o.FieldNotFound,null,{key:e});let s=t.typeIdField,f="id",c=t.types;if(t.subtypeField&&(s=t.subtypeField,f="code",c=t.subtypes??[]),null===r&&n&&s)r=n.hasField(s)?n.field(s):null;else if(s&&null!==r){let e=!1;for(const t of c||[])if(r===t[f]){e=!0;break}if(!e)for(const t of c||[])if(r===t.name){r=t[f],e=!0;break}e||(r=null,n&&s&&(r=n.hasField(s)?n.field(s):null))}return null!=r&&c.some((e=>e[f]===r&&(a=e.domains?.[l.name],a&&"inherited"===a.type&&(a=Ce(l.name,t),u=!0),!0))),u||a||(a=Ce(e,t)),{field:l,domain:a}}function Ce(e,t){let n;return t.fields.some((t=>(t.name.toLowerCase()===e.toLowerCase()&&(n=t.domain),!!n))),n}function je(e,t){t||(t={}),"function"==typeof t&&(t={cmp:t});const n="boolean"==typeof t.cycles&&t.cycles,r=t.cmp&&(a=t.cmp,function(e){return function(t,n){const r={key:t,value:e[t]},i={key:n,value:e[n]};return a(r,i)}});var a;const i=[];return function e(t){if(t?.toJSON&&"function"==typeof t.toJSON&&(t=t.toJSON()),void 0===t)return;if("number"==typeof t)return isFinite(t)?""+t:"null";if("object"!=typeof t)return JSON.stringify(t);let a,o;if(Array.isArray(t)){for(o="[",a=0;a<t.length;a++)a&&(o+=","),o+=e(t[a])||"null";return o+"]"}if(null===t)return"null";if(i.includes(t)){if(n)return JSON.stringify("__cycle__");throw new TypeError("Converting circular structure to JSON")}const u=i.push(t)-1,l=Object.keys(t).sort(r?.(t));for(o="",a=0;a<l.length;a++){const n=l[a],r=e(t[n]);r&&(o&&(o+=","),o+=JSON.stringify(n)+":"+r)}return i.splice(u,1),"{"+o+"}"}(e)}function Me(e){if(null===e)return null;const t=[];for(const n of e)n?.arcadeDeclaredClass&&"esri.arcade.Feature"===n.arcadeDeclaredClass?t.push(n.geometry()):t.push(n);return t}function Fe(e,t){if(!(t instanceof S))throw new i(null,o.InvalidParameter,null);e.push(t.hasZ?t.hasM?[t.x,t.y,t.z,t.m]:[t.x,t.y,t.z]:[t.x,t.y])}function we(e,t){if(U(e)||Q(e)){let n=!1,r=!1,a=[],u=t;if(U(e)){for(const t of e)Fe(a,t);a.length>0&&(u=e[0].spatialReference,n=e[0].hasZ,r=e[0].hasM)}else if(e instanceof f)a=e._elements,a.length>0&&(n=e._hasZ,r=e._hasM,u=e.get(0).spatialReference);else{if(!Q(e))throw new i(null,o.InvalidParameter,null);for(const t of e.toArray())Fe(a,t);a.length>0&&(u=e.get(0).spatialReference,n=!0===e.get(0).hasZ,r=!0===e.get(0).hasM)}if(0===a.length)return null;return T(a)||(a=a.slice(0).reverse()),new x({rings:[a],spatialReference:u,hasZ:n,hasM:r})}return e}function Oe(e,t){if(U(e)||Q(e)){let n=!1,r=!1,a=[],i=t;if(U(e)){for(const t of e)Fe(a,t);a.length>0&&(i=e[0].spatialReference,n=!0===e[0].hasZ,r=!0===e[0].hasM)}else if(e instanceof f)a=e._elements,a.length>0&&(n=e._hasZ,r=e._hasM,i=e.get(0).spatialReference);else if(Q(e)){for(const t of e.toArray())Fe(a,t);a.length>0&&(i=e.get(0).spatialReference,n=!0===e.get(0).hasZ,r=!0===e.get(0).hasM)}return 0===a.length?null:new Z({paths:[a],spatialReference:i,hasZ:n,hasM:r})}return e}function Re(e,t){if(U(e)||Q(e)){let n=!1,r=!1,a=[],i=t;if(U(e)){for(const t of e)Fe(a,t);a.length>0&&(i=e[0].spatialReference,n=!0===e[0].hasZ,r=!0===e[0].hasM)}else if(e instanceof f)a=e._elements,a.length>0&&(n=e._hasZ,r=e._hasM,i=e.get(0).spatialReference);else if(Q(e)){for(const t of e.toArray())Fe(a,t);a.length>0&&(i=e.get(0).spatialReference,n=!0===e.get(0).hasZ,r=!0===e.get(0).hasM)}return 0===a.length?null:new N({points:a,spatialReference:i,hasZ:n,hasM:r})}return e}function Je(e,t=!1){const n=[];if(null===e)return n;if(!0===U(e)){for(let r=0;r<e.length;r++){const a=de(e[r]);""===a&&!0!==t||n.push(a)}return n}if(e instanceof l){for(let r=0;r<e.length();r++){const a=de(e.get(r));""===a&&!0!==t||n.push(a)}return n}if(L(e)){const r=de(e);return""===r&&!0!==t||n.push(r),n}return[]}let ve=0;function Ie(e){return ve++,ve%100==0?(ve=0,new Promise((t=>{setTimeout((()=>{t(e)}),0)}))):e}function _e(e,t,n){switch(n){case"&":return e&t;case"|":return e|t;case"^":return e^t;case"<<":return e<<t;case">>":return e>>t;case">>>":return e>>>t}}function Le(e,t=null){return null==e?null:z(e)||E(e)||G(e)?e:e instanceof b?!0===t?.keepGeometryType?e:e.toJSON():e instanceof l?e.toArray().map((e=>Le(e,t))):e instanceof Array?e.map((e=>Le(e,t))):re(e)?e:X(e)?e.toJSDate():te(e)?e.toString():ee(e)?e.toJSDate():null!==e&&"object"==typeof e&&void 0!==e.castAsJson?e.castAsJson(t):null}async function Ye(e,t,n,r,a){const i=await Pe(e,t,n);a[r]=i}async function Pe(e,t=null,n=null){if(e instanceof l&&(e=e.toArray()),null==e)return null;if(L(e)||e instanceof b||re(e)||X(e))return Le(e,n);if(e instanceof Array){const r=[],a=[];for(const i of e)null===i||L(i)||i instanceof b||re(i)||X(i)?a.push(Le(i,n)):(a.push(null),r.push(Ye(i,t,n,a.length-1,a)));return r.length>0&&await Promise.all(r),a}return null!==e&&"object"==typeof e&&void 0!==e.castAsJsonAsync?e.castAsJsonAsync(t,n):null}function Ge(e){return ze(e)?e.parent:e}function ze(e){return e&&"declaredClass"in e&&"esri.layers.support.SubtypeSublayer"===e.declaredClass}function Ee(e){return e&&"declaredClass"in e&&"esri.layers.SubtypeGroupLayer"===e.declaredClass}function Ve(e,t,n){const r=Ge(e.fullSchema());if(null===r)return null;if(!r.fields)return null;return Ae(t,r,e,n)}function qe(e){const t=Ge(e.fullSchema());return null===t?null:t.fields?t.subtypeField?{subtypeField:t.subtypeField,subtypes:t.subtypes?t.subtypes.map((e=>({name:e.name,code:e.code}))):[]}:t.typeIdField?{subtypeField:t.typeIdField,subtypes:t.types?t.types.map((e=>({name:e.name,code:e.id}))):[]}:null:null}function Ue(e,t,n,r){const a=Ge(e.fullSchema());if(null===a)return null;if(!a.fields)return null;const i=Ae(t,a,e,r);if(void 0===n)try{n=e.field(t)}catch(o){return null}return Te(i,n)}function He(e,t,n,r){const a=Ge(e.fullSchema());if(null===a)return null;if(!a.fields)return null;if(void 0===n){try{n=e.field(t)}catch(i){return null}return n}return ke(Ae(t,a,e,r),n)}function Be(e){return e?.timeZone??"system"}function Ke(e){const t=Ge(e.fullSchema());if(null===t)return null;if(!t.fields)return null;const n=[];for(const r of t.fields)n.push(c(r));return{objectIdField:t.objectIdField,globalIdField:t.globalIdField??"",geometryType:void 0===m[t.geometryType]?"":m[t.geometryType],fields:n}}function We(r,a){return"system"===r&&(r=n.systemTimeZoneCanonicalName),{version:$e,engineVersion:t,timeZone:r,spatialReference:a instanceof D?a.toJSON():a,application:e.applicationName??"",engine:"web",locale:A()}}const $e="1.24",Qe=Object.freeze(Object.defineProperty({__proto__:null,ImplicitResultE:M,ReturnResultE:j,absRound:ie,arcadeVersion:$e,autoCastArrayOfPointsToMultiPoint:Re,autoCastArrayOfPointsToPolygon:we,autoCastArrayOfPointsToPolyline:Oe,autoCastFeatureToGeometry:Me,binaryOperator:_e,breakResult:R,castAsJson:Le,castAsJsonAsync:Pe,continueResult:J,defaultExecutingContext:We,defaultTimeZone:Be,defaultUndefined:Y,equalityTest:me,featureDomainCodeLookup:He,featureDomainValueLookup:Ue,featureFullDomain:Ve,featureSchema:Ke,featureSubtypes:qe,fixNullGeometry:De,fixSpatialReference:Ze,formatDate:le,formatNumber:ue,generateUUID:oe,getDomain:Ae,getDomainCode:ke,getDomainValue:Te,getType:P,greaterThanLessThan:ce,implicitResult:F,isArray:U,isBoolean:z,isDate:X,isDateOnly:ee,isDictionary:K,isFeature:H,isFeatureSet:B,isFeatureSetCollection:W,isFunctionParameter:I,isGeometry:q,isImmutableArray:Q,isInteger:V,isJsDate:re,isKnowledgeGraph:$,isModule:_,isNumber:E,isObject:ne,isSimpleType:L,isString:G,isSubtypeGrouplayer:Ee,isSubtypeSublayer:ze,isTime:te,multiReplace:v,parseGeometryFromJson:xe,pcCheck:ae,returnResult:w,stableStringify:je,standardiseDateFormat:se,tick:Ie,toBoolean:Se,toDate:be,toNumber:he,toNumberArray:pe,toString:de,toStringArray:Je,toStringExplicit:ye,voidOperation:O},Symbol.toStringTag,{value:"Module"}));export{pe as $,F as A,O as B,R as C,J as D,ce as E,me as F,_e as G,ae as H,Me as I,we as J,Y as K,Oe as L,Re as M,Be as N,V as O,P,se as Q,ie as R,De as S,v as T,oe as U,Ke as V,qe as W,Ve as X,Ue as Y,He as Z,We as _,z as a,Ee as a0,ze as a1,Ie as a2,Je as a3,Ae as a4,Te as a5,ke as a6,re as a7,j as a8,M as a9,_ as aa,ne as ab,ue as ac,le as ad,xe as ae,je as af,$e as ag,E as b,G as c,Le as d,Pe as e,L as f,he as g,Se as h,I as i,de as j,X as k,be as l,ee as m,te as n,U as o,q as p,Q as q,H as r,W as s,ye as t,B as u,K as v,$ as w,Ze as x,Qe as y,w as z};
