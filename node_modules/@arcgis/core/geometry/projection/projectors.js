/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.29/esri/copyright.txt for details.
*/
import{rad2deg as n,clamp as C,deg2rad as l,asinClamped as E}from"../../core/mathUtils.js";import{getMetersPerUnitForSR as e}from"../../core/unitUtils.js";import{isSphericalECEF as S,WGS84ECEFSpatialReferenceLike as A,SphericalPCPFMarsLike as _,SphericalPCPFMoonLike as t}from"../ellipsoidUtils.js";import{moon as R,mars as u,earth as r}from"../support/Ellipsoid.js";import{earthEllipsoidConstants as P}from"../support/geodesicConstants.js";import{isWGS84 as a,isWebMercator as O,isPlateCarree as L,isMars as M,isMoon as N,equals as c}from"../support/spatialReferenceUtils.js";import{SupportedGCSWkids as s}from"../support/SupportedGCSWkids.js";var o;!function(n){n[n.UNKNOWN=0]="UNKNOWN",n[n.SPHERICAL_ECEF=1]="SPHERICAL_ECEF",n[n.WGS84=2]="WGS84",n[n.WEB_MERCATOR=3]="WEB_MERCATOR",n[n.WGS84_ECEF=4]="WGS84_ECEF",n[n.CGCS2000=5]="CGCS2000",n[n.WGS84_COMPARABLE_LON_LAT=6]="WGS84_COMPARABLE_LON_LAT",n[n.SPHERICAL_MARS_PCPF=7]="SPHERICAL_MARS_PCPF",n[n.GCSMARS2000=8]="GCSMARS2000",n[n.SPHERICAL_MOON_PCPF=9]="SPHERICAL_MOON_PCPF",n[n.GCSMOON2000=10]="GCSMOON2000",n[n.LON_LAT=11]="LON_LAT",n[n.PLATE_CARREE=12]="PLATE_CARREE"}(o||(o={}));const i={[o.WGS84]:{[o.CGCS2000]:null,[o.GCSMARS2000]:null,[o.GCSMOON2000]:null,[o.LON_LAT]:f,[o.WGS84_COMPARABLE_LON_LAT]:f,[o.SPHERICAL_ECEF]:y,[o.SPHERICAL_MARS_PCPF]:null,[o.SPHERICAL_MOON_PCPF]:null,[o.UNKNOWN]:null,[o.WEB_MERCATOR]:d,[o.PLATE_CARREE]:B,[o.WGS84]:f,[o.WGS84_ECEF]:Y},[o.CGCS2000]:{[o.CGCS2000]:f,[o.GCSMARS2000]:null,[o.GCSMOON2000]:null,[o.LON_LAT]:f,[o.WGS84_COMPARABLE_LON_LAT]:f,[o.SPHERICAL_ECEF]:y,[o.SPHERICAL_MARS_PCPF]:null,[o.SPHERICAL_MOON_PCPF]:null,[o.UNKNOWN]:null,[o.WEB_MERCATOR]:null,[o.PLATE_CARREE]:B,[o.WGS84]:null,[o.WGS84_ECEF]:Y},[o.GCSMARS2000]:{[o.CGCS2000]:null,[o.GCSMARS2000]:f,[o.GCSMOON2000]:null,[o.LON_LAT]:f,[o.WGS84_COMPARABLE_LON_LAT]:null,[o.SPHERICAL_ECEF]:null,[o.SPHERICAL_MARS_PCPF]:x,[o.SPHERICAL_MOON_PCPF]:null,[o.UNKNOWN]:null,[o.WEB_MERCATOR]:null,[o.PLATE_CARREE]:null,[o.WGS84]:null,[o.WGS84_ECEF]:null},[o.GCSMOON2000]:{[o.CGCS2000]:null,[o.GCSMARS2000]:null,[o.GCSMOON2000]:f,[o.LON_LAT]:f,[o.WGS84_COMPARABLE_LON_LAT]:null,[o.SPHERICAL_ECEF]:null,[o.SPHERICAL_MARS_PCPF]:null,[o.SPHERICAL_MOON_PCPF]:k,[o.UNKNOWN]:null,[o.WEB_MERCATOR]:null,[o.PLATE_CARREE]:null,[o.WGS84]:null,[o.WGS84_ECEF]:null},[o.WEB_MERCATOR]:{[o.CGCS2000]:null,[o.GCSMARS2000]:null,[o.GCSMOON2000]:null,[o.LON_LAT]:I,[o.WGS84_COMPARABLE_LON_LAT]:I,[o.SPHERICAL_ECEF]:p,[o.SPHERICAL_MARS_PCPF]:null,[o.SPHERICAL_MOON_PCPF]:null,[o.UNKNOWN]:null,[o.WEB_MERCATOR]:f,[o.PLATE_CARREE]:K,[o.WGS84]:I,[o.WGS84_ECEF]:H},[o.WGS84_ECEF]:{[o.CGCS2000]:Z,[o.GCSMARS2000]:null,[o.GCSMOON2000]:null,[o.LON_LAT]:Z,[o.WGS84_COMPARABLE_LON_LAT]:Z,[o.SPHERICAL_ECEF]:$,[o.SPHERICAL_MARS_PCPF]:null,[o.SPHERICAL_MOON_PCPF]:null,[o.UNKNOWN]:null,[o.WEB_MERCATOR]:nn,[o.PLATE_CARREE]:m,[o.WGS84]:Z,[o.WGS84_ECEF]:f},[o.SPHERICAL_ECEF]:{[o.CGCS2000]:J,[o.GCSMARS2000]:null,[o.GCSMOON2000]:null,[o.LON_LAT]:J,[o.WGS84_COMPARABLE_LON_LAT]:J,[o.SPHERICAL_ECEF]:f,[o.SPHERICAL_MARS_PCPF]:null,[o.SPHERICAL_MOON_PCPF]:null,[o.UNKNOWN]:null,[o.WEB_MERCATOR]:Q,[o.PLATE_CARREE]:w,[o.WGS84]:J,[o.WGS84_ECEF]:V},[o.SPHERICAL_MARS_PCPF]:{[o.CGCS2000]:null,[o.GCSMARS2000]:D,[o.GCSMOON2000]:null,[o.LON_LAT]:D,[o.WGS84_COMPARABLE_LON_LAT]:null,[o.SPHERICAL_ECEF]:null,[o.SPHERICAL_MARS_PCPF]:f,[o.SPHERICAL_MOON_PCPF]:null,[o.UNKNOWN]:null,[o.WEB_MERCATOR]:null,[o.PLATE_CARREE]:null,[o.WGS84]:null,[o.WGS84_ECEF]:null},[o.SPHERICAL_MOON_PCPF]:{[o.CGCS2000]:null,[o.GCSMARS2000]:null,[o.GCSMOON2000]:z,[o.LON_LAT]:z,[o.WGS84_COMPARABLE_LON_LAT]:null,[o.SPHERICAL_ECEF]:null,[o.SPHERICAL_MARS_PCPF]:null,[o.SPHERICAL_MOON_PCPF]:f,[o.UNKNOWN]:null,[o.WEB_MERCATOR]:null,[o.PLATE_CARREE]:null,[o.WGS84]:null,[o.WGS84_ECEF]:null},[o.UNKNOWN]:{[o.CGCS2000]:null,[o.GCSMARS2000]:null,[o.GCSMOON2000]:null,[o.LON_LAT]:null,[o.WGS84_COMPARABLE_LON_LAT]:null,[o.SPHERICAL_ECEF]:null,[o.SPHERICAL_MARS_PCPF]:null,[o.SPHERICAL_MOON_PCPF]:null,[o.UNKNOWN]:f,[o.WEB_MERCATOR]:null,[o.PLATE_CARREE]:null,[o.WGS84]:null,[o.WGS84_ECEF]:null},[o.LON_LAT]:{[o.CGCS2000]:f,[o.GCSMARS2000]:f,[o.GCSMOON2000]:f,[o.LON_LAT]:f,[o.WGS84_COMPARABLE_LON_LAT]:f,[o.SPHERICAL_ECEF]:y,[o.SPHERICAL_MARS_PCPF]:x,[o.SPHERICAL_MOON_PCPF]:k,[o.UNKNOWN]:null,[o.WEB_MERCATOR]:d,[o.PLATE_CARREE]:B,[o.WGS84]:f,[o.WGS84_ECEF]:Y},[o.WGS84_COMPARABLE_LON_LAT]:{[o.CGCS2000]:null,[o.GCSMARS2000]:null,[o.GCSMOON2000]:null,[o.LON_LAT]:f,[o.WGS84_COMPARABLE_LON_LAT]:f,[o.SPHERICAL_ECEF]:y,[o.SPHERICAL_MARS_PCPF]:null,[o.SPHERICAL_MOON_PCPF]:null,[o.UNKNOWN]:null,[o.WEB_MERCATOR]:null,[o.PLATE_CARREE]:B,[o.WGS84]:f,[o.WGS84_ECEF]:Y},[o.PLATE_CARREE]:{[o.CGCS2000]:U,[o.GCSMARS2000]:null,[o.GCSMOON2000]:null,[o.LON_LAT]:U,[o.WGS84_COMPARABLE_LON_LAT]:U,[o.SPHERICAL_ECEF]:j,[o.SPHERICAL_MARS_PCPF]:null,[o.SPHERICAL_MOON_PCPF]:null,[o.UNKNOWN]:null,[o.WEB_MERCATOR]:q,[o.PLATE_CARREE]:f,[o.WGS84]:U,[o.WGS84_ECEF]:g}};function G(n){const C=F(n,En);return i[C][o.WGS84_COMPARABLE_LON_LAT]}function W(n,C,l=ln()){return null==n||null==C?null:Cn(n,C,l).projector}function T(n,C){switch(W(n,C,Sn)){case f:return"copy3";case y:return"wgs84ToSphericalECEF";case d:return"wgs84ToWebMercator";case B:return"wgs84ToPlateCarree";case Y:return"wgs84ToWGS84ECEF";case I:return"webMercatorToWGS84";case p:return"webMercatorToSphericalECEF";case H:return"webMercatorToWGS84ECEF";case K:return"webMercatorToPlateCarree";case Z:return"wgs84ECEFToWGS84";case $:return"wgs84ECEFToSphericalECEF";case nn:return"wgs84ECEFToWebMercator";case J:return"sphericalECEFToWGS84";case Q:return"sphericalECEFToWebMercator";case D:return"sphericalMarsPCPFToMars2000";case z:return"sphericalMoonPCPFToMoon2000";case V:return"sphericalECEFToWGS84ECEF";case x:return"mars2000ToSphericalPCPF";case k:return"moon2000ToSphericalPCPF";default:return null}}function F(n,C){return n?C.spatialReference===n?C.spatialReferenceId:(C.spatialReference=n,"metersPerUnit"in C&&(C.metersPerUnit=e(n,1)),S(n)?C.spatialReferenceId=o.SPHERICAL_ECEF:a(n)?C.spatialReferenceId=o.WGS84:O(n)?C.spatialReferenceId=o.WEB_MERCATOR:L(n)?C.spatialReferenceId=o.PLATE_CARREE:n.wkt===A.wkt?C.spatialReferenceId=o.WGS84_ECEF:n.wkid===s.CGCS2000?C.spatialReferenceId=o.CGCS2000:n.wkt===_.wkt?C.spatialReferenceId=o.SPHERICAL_MARS_PCPF:n.wkt===t.wkt?C.spatialReferenceId=o.SPHERICAL_MOON_PCPF:M(n)?C.spatialReferenceId=o.GCSMARS2000:N(n)?C.spatialReferenceId=o.GCSMOON2000:C.spatialReferenceId=o.UNKNOWN):o.UNKNOWN}function f(n,C,l,E){n!==l&&(l[E++]=n[C++],l[E++]=n[C++],l[E]=n[C])}function I(n,C,l,E){l[E]=_n*(n[C]/un),l[E+1]=_n*(Rn-2*Math.atan(Math.exp(-n[C+1]/un))),l[E+2]=n[C+2]}function p(n,C,l,E){const e=n[C]/un,S=Rn-2*Math.atan(Math.exp(-n[C+1]/un)),A=un+n[C+2],_=Math.cos(S)*A;l[E]=Math.cos(e)*_,l[E+1]=Math.sin(e)*_,l[E+2]=Math.sin(S)*A}function H(n,C,l,E){I(n,C,l,E),Y(l,E,l,E)}function h(n,l,E,e,S){const A=.4999999*tn,_=C(An*n[l+1],-A,A),t=Math.sin(_);E[e++]=An*n[l]*S.radius,E[e++]=S.halfSemiMajorAxis*Math.log((1+t)/(1-t)),E[e]=n[l+2]}function d(n,C,l,E){h(n,C,l,E,r)}function B(n,C,l,E){l[E]=n[C]*rn,l[E+1]=n[C+1]*rn,l[E+2]=n[C+2]}function U(n,C,l,E){l[E]=n[C]*Pn,l[E+1]=n[C+1]*Pn,l[E+2]=n[C+2]}function K(n,C,l,E){I(n,C,l,E),B(l,E,l,E)}function m(n,C,l,E){Z(n,C,l,E),B(l,E,l,E)}function w(n,C,l,E){J(n,C,l,E),B(l,E,l,E)}function j(n,C,l,E){U(n,C,l,E),y(l,E,l,E)}function q(n,C,l,E){U(n,C,l,E),d(l,E,l,E)}function g(n,C,l,E){U(n,C,l,E),Y(l,E,l,E)}function b(n,C,l,E,e){const S=e+n[C+2],A=An*n[C+1],_=An*n[C],t=Math.cos(A)*S;l[E]=Math.cos(_)*t,l[E+1]=Math.sin(_)*t,l[E+2]=Math.sin(A)*S}function k(n,C,l,E){b(n,C,l,E,R.radius)}function x(n,C,l,E){b(n,C,l,E,u.radius)}function y(n,C,l,E){b(n,C,l,E,r.radius)}function v(n,C,l,e,S){const A=n[C],_=n[C+1],t=n[C+2],R=Math.sqrt(A*A+_*_+t*t),u=E(t/(0===R?1:R)),r=Math.atan2(_,A);l[e++]=_n*r,l[e++]=_n*u,l[e]=R-S}function z(n,C,l,E){v(n,C,l,E,R.radius)}function D(n,C,l,E){v(n,C,l,E,u.radius)}function J(n,C,l,E){v(n,C,l,E,r.radius)}function Q(n,C,l,E){J(n,C,l,E),d(l,E,l,E)}function V(n,C,l,E){J(n,C,l,E),Y(l,E,l,E)}function X(n,C,l,E,e){const S=An*n[C],A=An*n[C+1],_=n[C+2],t=Math.sin(A),R=Math.cos(A),u=e.radius/Math.sqrt(1-e.eccentricitySquared*t*t);l[E++]=(u+_)*R*Math.cos(S),l[E++]=(u+_)*R*Math.sin(S),l[E++]=(u*(1-e.eccentricitySquared)+_)*t}function Y(n,C,l,E){X(n,C,l,E,r)}function Z(n,C,l,E){const e=P,S=n[C],A=n[C+1],_=n[C+2];let t,R,u,a,O,L,M,N,c,s,o,i,G,W,T,F,f,I,p,H,h;t=Math.abs(_),R=S*S+A*A,u=Math.sqrt(R),a=R+_*_,O=Math.sqrt(a),H=Math.atan2(A,S),L=_*_/a,M=R/a,W=e.a2/O,T=e.a3-e.a4/O,M>.3?(N=t/O*(1+M*(e.a1+W+L*T)/O),p=Math.asin(N),s=N*N,c=Math.sqrt(1-s)):(c=u/O*(1-L*(e.a5-W-M*T)/O),p=Math.acos(c),s=1-c*c,N=Math.sqrt(s)),o=1-r.eccentricitySquared*s,i=r.radius/Math.sqrt(o),G=e.a6*i,W=u-i*c,T=t-G*N,f=c*W+N*T,F=c*T-N*W,I=F/(G/o+f),p+=I,h=f+F*I/2,_<0&&(p=-p),l[E++]=_n*H,l[E++]=_n*p,l[E]=h}function $(n,C,l,E){Z(n,C,l,E),y(l,E,l,E)}function nn(n,C,l,E){Z(n,C,l,E),d(l,E,l,E)}function Cn(n,C,l){if(null==n||null==C||l.source.spatialReference===n&&l.dest.spatialReference===C)return l;const E=F(n,l.source),e=F(C,l.dest);return E===o.UNKNOWN&&e===o.UNKNOWN?c(n,C)?l.projector=f:l.projector=null:l.projector=i[E][e],l}function ln(){return{source:{spatialReference:null,spatialReferenceId:o.UNKNOWN,metersPerUnit:1},dest:{spatialReference:null,spatialReferenceId:o.UNKNOWN,metersPerUnit:1},projector:f}}const En={spatialReference:null,spatialReferenceId:o.UNKNOWN},en={spatialReference:null,spatialReferenceId:o.UNKNOWN},Sn=ln(),An=l(1),_n=n(1),tn=Math.PI,Rn=.5*tn,un=r.radius,rn=un*tn/180,Pn=180/(un*tn);export{o as ProjectionID,F as classifySpatialReference,f as copy3,ln as createEmptyProjectorCache,en as destClassificationCache,W as getProjector,T as getProjectorName,G as getWGS84ComparableLonLatProjector,Pn as invPlateCarreeScale,h as lonLatToWebMercatorComparable,Cn as populateProjectorCache,i as projectionTable,Sn as projectorCache,En as sourceClassificationCache,v as sphericalPCPFtoLonLatElevation,d as wgs84ToWebMercator};
